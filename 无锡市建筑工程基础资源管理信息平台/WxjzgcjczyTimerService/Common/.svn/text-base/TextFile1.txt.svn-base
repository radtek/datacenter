   Public.WriteLog("获取" + tag + "人员信息：");
                        #region

                        byte[] bytes = dataDownService.getPersonInfoStream(userID, "320200", xzqdm, String.Empty, "0");

                        string result = System.Text.Encoding.UTF8.GetString(bytes, 0, bytes.Length);

                        var index = result.IndexOf("<ReturnInfo>");
                        if (index >= 0)
                        {
                            string returnResult = result.Substring(index, result.LastIndexOf("</ReturnInfo>") - index + 13);
                            if (string.IsNullOrEmpty(returnResult))
                            {
                                continue;
                            }

                            ReturnInfo returnInfo = helper.DeserializeXML<ReturnInfo>(returnResult);
                            if (!returnInfo.Status)
                            {
                                continue;
                            }

                        }
                        else
                        {
                            continue;
                        }
                        //string str = result.Substring(result.IndexOf("</ReturnInfo>") + 13, result.IndexOf("</ResultSet>") - result.IndexOf("</ReturnInfo>") - 13);
                        //if (string.IsNullOrEmpty(str))
                        //{
                        //    continue;
                        //}

                        index = result.IndexOf("<PersonBasicInfo>");
                        if (index >= 0)
                        {
                            string personBasicInfoString = result.Substring(index, result.LastIndexOf("</PersonBasicInfo>") - index + 18);
                            PersonBasicInfoBody personBasicInfoBody = helper.DeserializeXML<PersonBasicInfoBody>("<PersonBasicInfoBody><PersonBasicInfoArray>" + personBasicInfoString + "</PersonBasicInfoArray></PersonBasicInfoBody>");

                            PersonRegCertBody personRegCertBody = new PersonRegCertBody();
                            PersonRegMajorBody personRegMajorBody = new PersonRegMajorBody();

                            index = result.IndexOf("<PersonRegCert>");
                            if (index >= 0)
                            {

                                string personRegCertString = result.Substring(index, result.LastIndexOf("</PersonRegCert>") - index + 16);
                                personRegCertBody = helper.DeserializeXML<PersonRegCertBody>("<PersonRegCertBody><PersonRegCertArray>" + personRegCertString + "</PersonRegCertArray></PersonRegCertBody>");

                            }

                            index = result.IndexOf("<PersonRegMajor>");
                            if (index >= 0)
                            {
                                string personRegMajorString = result.Substring(index, result.LastIndexOf("</PersonRegMajor>") - index + 17);
                                personRegMajorBody = helper.DeserializeXML<PersonRegMajorBody>("<PersonRegMajorBody><PersonRegMajorArray>" + personRegMajorString + "</PersonRegMajorArray></PersonRegMajorBody>");

                            }

                            #region 人员基本信息

                            if (personBasicInfoBody != null)
                            {
                                int rowIndex = -1;
                                foreach (PersonBasicInfo personBasicInfo in personBasicInfoBody.array)
                                {
                                    DataRow row_SaveDataLog = dt_SaveDataLog.NewRow();
                                    row_SaveDataLog["DataJkDataDetailID"] = row_DataJkDataDetail_ryxx["ID"];
                                    row_SaveDataLog["DataXml"] = "";
                                    row_SaveDataLog["PKID"] = personBasicInfo.IDCardNo;
                                    row_SaveDataLog["CreateDate"] = DateTime.Now.ToString("yyyy-MM-dd");

                                    try
                                    {
                                        DataTable dt_ryxx = dataService.Get_UEPP_Ryjbxx(personBasicInfo.IDCardNo);
                                        if (dt_ryxx.Rows.Count == 0)
                                        {
                                            row = dt_ryxx.NewRow();
                                            dt_ryxx.Rows.Add(row);
                                            row["ryID"] = personBasicInfo.IDCardNo;
                                        }
                                        else
                                        {
                                            row = dt_ryxx.Rows[0];
                                            if (!string.IsNullOrEmpty(row["xgrqsj"].ToString2()) && !string.IsNullOrEmpty(personBasicInfo.UpdateDate))
                                                if (DateTime.Parse(row["xgrqsj"].ToString()).ToString("yyyy-MM-dd") == DateTime.Parse(personBasicInfo.UpdateDate).ToString("yyyy-MM-dd"))
                                                {
                                                    continue;
                                                }
                                        }
                                        row["tag"] = tag;
                                        row["xm"] = personBasicInfo.PersonName;
                                        switch (personBasicInfo.IDCardType)
                                        {
                                            case "身份证":
                                                row["zjlxID"] = "1";
                                                break;
                                            case "护照":
                                                row["zjlxID"] = "3";
                                                break;
                                            case "军官证":
                                                row["zjlxID"] = "2";
                                                break;
                                            case "台湾居民身份证":
                                                row["zjlxID"] = "4";
                                                break;
                                            case "香港永久性居民身份证":
                                                row["zjlxID"] = "5";
                                                break;
                                            case "警官证":
                                                row["zjlxID"] = "6";
                                                break;
                                            case "其他":
                                                row["zjlxID"] = "9";
                                                break;
                                        }

                                        row["zjlx"] = personBasicInfo.IDCardType;
                                        row["zjhm"] = personBasicInfo.IDCardNo;
                                        row["xb"] = personBasicInfo.Sex;
                                        if (!string.IsNullOrEmpty(personBasicInfo.Birthday))
                                            row["csrq"] = personBasicInfo.Birthday;
                                        row["mz"] = personBasicInfo.Nationality;
                                        row["zc"] = personBasicInfo.ProTitle;
                                        row["zw"] = personBasicInfo.DutyDesc;
                                        if (string.IsNullOrEmpty(personBasicInfo.UpdateDate))
                                            personBasicInfo.UpdateDate = DateTime.Now.ToString("yyyy-MM-dd");
                                        row["xgrqsj"] = personBasicInfo.UpdateDate;

                                        row["xgr"] = "定时服务";
                                        row["DataState"] = 0;
                                        row["AJ_EXISTINIDCARDS"] = "2";
                                        row["AJ_IsRefuse"] = "0";

                                        allCount_ryxx++;
                                        if (!dataService.Submit_uepp_ryjbxx(dt_ryxx))
                                        {
                                            //Public.WriteLog("建设单位人员信息保存失败，ryID：" + personBasicInfo.IDCardNo);
                                            row_SaveDataLog["SaveState"] = 0;
                                            row_SaveDataLog["Msg"] = "建设单位人员信息保存失败，ryID：" + personBasicInfo.IDCardNo;
                                        }
                                        else
                                        {
                                            success_count_ryxx++;

                                            row_SaveDataLog["SaveState"] = 1;
                                            row_SaveDataLog["Msg"] = "";
                                        }
                                        dt_SaveDataLog.Rows.Add(row_SaveDataLog);

                                    }
                                    catch (Exception ex)
                                    {
                                        //Public.WriteLog("出现异常，ryID：" + personBasicInfo.IDCardNo + ",Exception:" + ex.Message);

                                        row_SaveDataLog["SaveState"] = 0;
                                        row_SaveDataLog["Msg"] = ex.Message;
                                        dt_SaveDataLog.Rows.Add(row_SaveDataLog);
                                    }

                                }
                            }
                            #endregion

                            #region 人员执业资格，人员证书，企业人员关系

                            if (personRegCertBody != null)
                            {
                                foreach (PersonRegCert personRegCert in personRegCertBody.array)
                                {
                                    try
                                    {
                                        if (string.IsNullOrEmpty(personRegCert.UpdateDate))
                                            personRegCert.UpdateDate = DateTime.Now.ToString("yyyy-MM-dd");

                                        int rowIndex = -1;
                                        string regType = personRegCert.RegType;

                                        if (string.IsNullOrEmpty(personRegCert.UpdateDate))
                                            personRegCert.UpdateDate = DateTime.Now.ToString("yyyy-MM-dd");

                                        if (regType.IndexOf("注册建筑师") >= 0)
                                        {
                                            #region 人员执业资格
                                            rowIndex = -1;
                                            DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                            for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                            {
                                                if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == "51")
                                                {
                                                    rowIndex = i;
                                                    break;
                                                }
                                            }
                                            if (rowIndex < 0)
                                            {
                                                row = dt_ryzyzg.NewRow();
                                                dt_ryzyzg.Rows.Add(row);
                                                row["ryID"] = personRegCert.IDCardNo;
                                                row["ryzyzglxID"] = 51;
                                                row["ryzyzglx"] = "注册建筑师";

                                                row["balxID"] = 1;
                                                row["balx"] = "长期备案";

                                                row["DataState"] = 0;
                                                row["tag"] = tag;
                                                row["xgr"] = "定时服务";
                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                            }
                                            #endregion

                                            #region 人员证书基本信息
                                            DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                            rowIndex = -1;
                                            for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                            {
                                                if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == "51")
                                                {
                                                    rowIndex = i;
                                                    break;
                                                }
                                            }
                                            if (rowIndex < 0)
                                            {
                                                row = dt_ryzs.NewRow();
                                                dt_ryzs.Rows.Add(row);
                                                row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                row["ryID"] = personRegCert.IDCardNo;
                                                row["ryzyzglxID"] = 51;
                                                row["ryzyzglx"] = "注册建筑师";
                                                row["ryzslxID"] = 151;
                                                row["ryzslx"] = "注册建筑师资格证";
                                                row["sfzzz"] = 1;
                                                row["zsbh"] = personRegCert.QualCertNo;
                                                if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                {
                                                    row["fzrq"] = personRegCert.IssueDate;
                                                    row["zsyxqrq"] = personRegCert.IssueDate;
                                                }
                                                if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                    row["zsyxzrq"] = personRegCert.ValidDate;

                                                row["fzdw"] = personRegCert.IssueOrgan;

                                                row["Status"] = personRegCert.Status;
                                                row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                row["StampNo"] = personRegCert.StampNo;
                                                row["RegNo"] = personRegCert.RegNo;

                                                row["DataState"] = 0;
                                                row["tag"] = tag;
                                                row["xgr"] = "定时服务";
                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                dataService.Submit_uepp_Ryzs(dt_ryzs);

                                            }

                                            #endregion

                                            #region 企业人员关系表

                                            DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, "51");
                                            if (dt_qyry.Rows.Count == 0)
                                            {
                                                if (personRegCert.Status.ToString2() != "2")
                                                {
                                                    row = dt_qyry.NewRow();
                                                    dt_qyry.Rows.Add(row);
                                                    row["ryID"] = personRegCert.IDCardNo;
                                                    row["qyID"] = personRegCert.CorpCode;
                                                    row["ryzyzglxID"] = 51;
                                                    row["ryzyzglx"] = "注册建筑师";
                                                    row["DataState"] = 0;
                                                    row["tag"] = tag;
                                                    row["xgr"] = "定时服务";
                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                    dataService.Submit_uepp_qyry(dt_qyry);
                                                }
                                            }
                                            else
                                            {
                                                if (personRegCert.Status.ToString2() == "2")
                                                {
                                                    foreach (DataRow item in dt_qyry.Rows)
                                                    {
                                                        item.Delete();
                                                    }

                                                    dataService.Submit_uepp_qyry(dt_qyry);
                                                }
                                            }
                                            #endregion
                                        }
                                        else
                                            if (regType.IndexOf("注册结构工程师") >= 0)
                                            {
                                                #region 人员执业资格
                                                DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                rowIndex = -1;
                                                for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                {
                                                    if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == "61")
                                                    {
                                                        rowIndex = i;
                                                        break;
                                                    }
                                                }
                                                if (rowIndex < 0)
                                                {
                                                    row = dt_ryzyzg.NewRow();
                                                    dt_ryzyzg.Rows.Add(row);
                                                    row["ryID"] = personRegCert.IDCardNo;
                                                    row["ryzyzglxID"] = 61;
                                                    row["ryzyzglx"] = "注册结构师";
                                                    row["balxID"] = 1;
                                                    row["balx"] = "长期备案";
                                                    row["DataState"] = 0;
                                                    row["tag"] = tag;
                                                    row["xgr"] = "定时服务";
                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                    dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                }
                                                #endregion

                                                #region 人员证书
                                                DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                rowIndex = -1;
                                                for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                {
                                                    if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == "61")
                                                    {
                                                        rowIndex = i;
                                                        break;
                                                    }
                                                }
                                                if (rowIndex < 0)
                                                {
                                                    row = dt_ryzs.NewRow();
                                                    dt_ryzs.Rows.Add(row);
                                                    row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                    row["ryID"] = personRegCert.IDCardNo;
                                                    row["ryzyzglxID"] = 61;
                                                    row["ryzyzglx"] = "注册结构师";
                                                    row["ryzslxID"] = 161;
                                                    row["ryzslx"] = "注册结构师资格证";
                                                    row["sfzzz"] = 1;
                                                    row["zsbh"] = personRegCert.QualCertNo;

                                                    row["Status"] = personRegCert.Status;
                                                    row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                    row["StampNo"] = personRegCert.StampNo;

                                                    if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                    {
                                                        row["fzrq"] = personRegCert.IssueDate;
                                                        row["zsyxqrq"] = personRegCert.IssueDate;
                                                    }
                                                    if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                        row["zsyxzrq"] = personRegCert.ValidDate;
                                                    row["fzdw"] = personRegCert.IssueOrgan;

                                                    row["DataState"] = 0;
                                                    row["tag"] = tag;
                                                    row["xgr"] = "定时服务";
                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                    dataService.Submit_uepp_Ryzs(dt_ryzs);
                                                }
                                                #endregion

                                                #region 企业与人员及其执业资格对应关系
                                                DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, "61");
                                                if (dt_qyry.Rows.Count == 0)
                                                {
                                                    if (personRegCert.Status.ToString2() != "2")
                                                    {
                                                        row = dt_qyry.NewRow();
                                                        dt_qyry.Rows.Add(row);
                                                        row["ryID"] = personRegCert.IDCardNo;
                                                        row["qyID"] = personRegCert.CorpCode;
                                                        row["ryzyzglxID"] = 61;
                                                        row["ryzyzglx"] = "注册结构师";
                                                        row["DataState"] = 0;
                                                        row["tag"] = tag;
                                                        row["xgr"] = "定时服务";
                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                        dataService.Submit_uepp_qyry(dt_qyry);
                                                    }
                                                }
                                                else
                                                {
                                                    if (personRegCert.Status.ToString2() == "2")
                                                    {
                                                        foreach (DataRow item in dt_qyry.Rows)
                                                        {
                                                            item.Delete();
                                                        }

                                                        dataService.Submit_uepp_qyry(dt_qyry);
                                                    }
                                                }
                                                #endregion

                                            }
                                            else
                                                if (regType.IndexOf("注册土木工程师（岩土）") >= 0)
                                                {
                                                    #region 执业资格

                                                    DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                    rowIndex = -1;
                                                    for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                    {
                                                        if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == "73")
                                                        {
                                                            rowIndex = i;
                                                            break;
                                                        }
                                                    }
                                                    if (rowIndex < 0)
                                                    {
                                                        row = dt_ryzyzg.NewRow();
                                                        dt_ryzyzg.Rows.Add(row);
                                                        row["ryID"] = personRegCert.IDCardNo;
                                                        row["ryzyzglxID"] = 73;
                                                        row["ryzyzglx"] = "注册土木工程师（岩土）";
                                                        row["balxID"] = 1;
                                                        row["balx"] = "长期备案";
                                                        row["DataState"] = 0;
                                                        row["tag"] = tag;
                                                        row["xgr"] = "定时服务";
                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                        dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                    }

                                                    #endregion

                                                    #region 人员证书
                                                    DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                    rowIndex = -1;
                                                    for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                    {
                                                        if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == "73")
                                                        {
                                                            rowIndex = i;
                                                            break;
                                                        }
                                                    }
                                                    if (rowIndex < 0)
                                                    {
                                                        row = dt_ryzs.NewRow();
                                                        dt_ryzs.Rows.Add(row);
                                                        row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                        row["ryID"] = personRegCert.IDCardNo;
                                                        row["ryzyzglxID"] = 73;
                                                        row["ryzyzglx"] = "注册土木工程师（岩土）";
                                                    }
                                                    else
                                                    {
                                                        row = dt_ryzs.Rows[0];
                                                    }
                                                    row["ryzslxID"] = 731;
                                                    row["ryzslx"] = "注册土木工程师（岩土）资格证";
                                                    row["sfzzz"] = 1;
                                                    row["zsbh"] = personRegCert.QualCertNo;

                                                    row["Status"] = personRegCert.Status;
                                                    row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                    row["StampNo"] = personRegCert.StampNo;

                                                    if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                    {
                                                        row["fzrq"] = personRegCert.IssueDate;
                                                        row["zsyxqrq"] = personRegCert.IssueDate;
                                                    }
                                                    if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                        row["zsyxzrq"] = personRegCert.ValidDate;
                                                    row["fzdw"] = personRegCert.IssueOrgan;

                                                    row["DataState"] = 0;
                                                    row["tag"] = tag;
                                                    row["xgr"] = "定时服务";
                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                    dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                    #endregion

                                                    #region 企业与人员及其执业资格对应关系
                                                    DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, "73");
                                                    if (dt_qyry.Rows.Count == 0)
                                                    {
                                                        if (personRegCert.Status.ToString2() != "2")
                                                        {
                                                            row = dt_qyry.NewRow();
                                                            dt_qyry.Rows.Add(row);
                                                            row["ryID"] = personRegCert.IDCardNo;
                                                            row["qyID"] = personRegCert.CorpCode;
                                                            row["ryzyzglxID"] = 73;
                                                            row["ryzyzglx"] = "注册土木工程师（岩土）";
                                                            row["DataState"] = 0;
                                                            row["tag"] = tag;
                                                            row["xgr"] = "定时服务";
                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                            dataService.Submit_uepp_qyry(dt_qyry);
                                                        }
                                                    }
                                                    else
                                                        if (personRegCert.Status.ToString2() == "2")
                                                        {
                                                            //dt_qyry.Rows[0].Delete();
                                                            foreach (DataRow item in dt_qyry.Rows)
                                                            {
                                                                item.Delete();
                                                            }

                                                            dataService.Submit_uepp_qyry(dt_qyry);
                                                        }
                                                    #endregion

                                                }
                                                else
                                                    if (regType.IndexOf("注册土木工程师（港口与航道工程）") >= 0)
                                                    {
                                                        #region 执业资格

                                                        DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                        rowIndex = -1;
                                                        for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                        {
                                                            if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == "84")
                                                            {
                                                                rowIndex = i;
                                                                break;
                                                            }
                                                        }
                                                        if (rowIndex < 0)
                                                        {
                                                            row = dt_ryzyzg.NewRow();
                                                            dt_ryzyzg.Rows.Add(row);
                                                            row["ryID"] = personRegCert.IDCardNo;
                                                            row["ryzyzglxID"] = 84;
                                                            row["ryzyzglx"] = "注册土木工程师（港口与航道工程）";
                                                            row["balxID"] = 1;
                                                            row["balx"] = "长期备案";
                                                            row["DataState"] = 0;
                                                            row["tag"] = tag;
                                                            row["xgr"] = "定时服务";
                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                            dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                        }


                                                        #endregion

                                                        #region 人员证书
                                                        rowIndex = -1;
                                                        DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                        for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                        {
                                                            if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == "84")
                                                            {
                                                                rowIndex = i;
                                                                break;
                                                            }
                                                        }
                                                        if (rowIndex < 0)
                                                        {
                                                            row = dt_ryzs.NewRow();
                                                            dt_ryzs.Rows.Add(row);
                                                            row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                            row["ryID"] = personRegCert.IDCardNo;
                                                            row["ryzyzglxID"] = 84;
                                                            row["ryzyzglx"] = "注册土木工程师（港口与航道工程）";
                                                            row["ryzslxID"] = 841;
                                                            row["ryzslx"] = "注册土木工程师（港口与航道工程）资格证";
                                                            row["sfzzz"] = 1;
                                                        }
                                                        else
                                                        {
                                                            row = dt_ryzs.Rows[0];
                                                        }

                                                        row["zsbh"] = personRegCert.QualCertNo;
                                                        if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                        {
                                                            row["fzrq"] = personRegCert.IssueDate;
                                                            row["zsyxqrq"] = personRegCert.IssueDate;
                                                        }
                                                        if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                            row["zsyxzrq"] = personRegCert.ValidDate;
                                                        row["fzdw"] = personRegCert.IssueOrgan;

                                                        row["Status"] = personRegCert.Status;
                                                        row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                        row["StampNo"] = personRegCert.StampNo;

                                                        row["DataState"] = 0;
                                                        row["tag"] = tag;
                                                        row["xgr"] = "定时服务";
                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                        dataService.Submit_uepp_Ryzs(dt_ryzs);


                                                        #endregion

                                                        #region 企业与人员及其执业资格对应关系
                                                        DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, "84");
                                                        if (dt_qyry.Rows.Count == 0)
                                                        {
                                                            if (personRegCert.Status.ToString2() != "2")
                                                            {
                                                                row = dt_qyry.NewRow();
                                                                dt_qyry.Rows.Add(row);
                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                row["qyID"] = personRegCert.CorpCode;
                                                                row["ryzyzglxID"] = 84;
                                                                row["ryzyzglx"] = "注册土木工程师（港口与航道工程）";
                                                                row["DataState"] = 0;
                                                                row["tag"] = tag;
                                                                row["xgr"] = "定时服务";
                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                dataService.Submit_uepp_qyry(dt_qyry);
                                                            }
                                                        }
                                                        else
                                                        {
                                                            if (personRegCert.Status.ToString2() == "2")
                                                            {
                                                                //dt_qyry.Rows[0].Delete();
                                                                foreach (DataRow item in dt_qyry.Rows)
                                                                {
                                                                    item.Delete();
                                                                }
                                                                dataService.Submit_uepp_qyry(dt_qyry);
                                                            }
                                                        }
                                                        #endregion

                                                    }
                                                    else
                                                        if (regType.IndexOf("注册公用设备工程师（暖通空调）") >= 0)
                                                        {
                                                            #region 执业资格
                                                            DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                            rowIndex = -1;
                                                            for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                            {
                                                                if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == "74")
                                                                {
                                                                    rowIndex = i;
                                                                    break;
                                                                }
                                                            }
                                                            if (rowIndex < 0)
                                                            {
                                                                row = dt_ryzyzg.NewRow();
                                                                dt_ryzyzg.Rows.Add(row);
                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                row["ryzyzglxID"] = 74;
                                                                row["ryzyzglx"] = "注册土木工程师（港口与航道工程）";
                                                                row["balxID"] = 1;
                                                                row["balx"] = "长期备案";
                                                                row["DataState"] = 0;
                                                                row["tag"] = tag;
                                                                row["xgr"] = "定时服务";
                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                            }

                                                            #endregion

                                                            #region 人员证书
                                                            DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                            rowIndex = -1;
                                                            for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                            {
                                                                if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == "74")
                                                                {
                                                                    rowIndex = i;
                                                                    break;
                                                                }
                                                            }
                                                            if (rowIndex < 0)
                                                            {

                                                                row = dt_ryzs.NewRow();
                                                                dt_ryzs.Rows.Add(row);
                                                                row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                row["ryzyzglxID"] = 74;
                                                                row["ryzyzglx"] = "注册公用设备工程师（暖通空调）";
                                                                row["ryzslxID"] = 741;
                                                                row["ryzslx"] = "注册公用设备工程师（暖通空调）资格证";
                                                                row["sfzzz"] = 1;
                                                            }
                                                            else
                                                            {
                                                                row = dt_ryzs.Rows[rowIndex];
                                                            }

                                                            row["zsbh"] = personRegCert.QualCertNo;
                                                            if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                            {
                                                                row["fzrq"] = personRegCert.IssueDate;
                                                                row["zsyxqrq"] = personRegCert.IssueDate;
                                                            }
                                                            if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                row["zsyxzrq"] = personRegCert.ValidDate;
                                                            row["fzdw"] = personRegCert.IssueOrgan;

                                                            row["Status"] = personRegCert.Status;
                                                            row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                            row["StampNo"] = personRegCert.StampNo;

                                                            row["DataState"] = 0;
                                                            row["tag"] = tag;
                                                            row["xgr"] = "定时服务";
                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                            dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                            #endregion

                                                            #region 企业与人员及其执业资格对应关系
                                                            DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, "74");
                                                            if (dt_qyry.Rows.Count == 0)
                                                            {
                                                                if (personRegCert.Status.ToString2() != "2")
                                                                {
                                                                    row = dt_qyry.NewRow();
                                                                    dt_qyry.Rows.Add(row);
                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                    row["qyID"] = personRegCert.CorpCode;
                                                                    row["ryzyzglxID"] = 74;
                                                                    row["ryzyzglx"] = "注册公用设备工程师（暖通空调）";
                                                                    row["DataState"] = 0;
                                                                    row["tag"] = tag;
                                                                    row["xgr"] = "定时服务";
                                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                                    dataService.Submit_uepp_qyry(dt_qyry);
                                                                }
                                                            }
                                                            else
                                                            {
                                                                if (personRegCert.Status.ToString2() == "2")
                                                                {
                                                                    foreach (DataRow item in dt_qyry.Rows)
                                                                    {
                                                                        item.Delete();
                                                                    }

                                                                    dataService.Submit_uepp_qyry(dt_qyry);

                                                                }
                                                            }
                                                            #endregion

                                                        }
                                                        else
                                                            if (regType.IndexOf("注册公用设备工程师（给水排水）") >= 0)
                                                            {
                                                                #region 执业资格
                                                                DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                rowIndex = -1;
                                                                for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                {
                                                                    if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == "75")
                                                                    {
                                                                        rowIndex = i;
                                                                        break;
                                                                    }
                                                                }
                                                                if (rowIndex < 0)
                                                                {
                                                                    row = dt_ryzyzg.NewRow();
                                                                    dt_ryzyzg.Rows.Add(row);
                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                    row["ryzyzglxID"] = 75;
                                                                    row["ryzyzglx"] = "注册公用设备工程师（给水排水）";
                                                                    row["balxID"] = 1;
                                                                    row["balx"] = "长期备案";
                                                                    row["DataState"] = 0;
                                                                    row["tag"] = tag;
                                                                    row["xgr"] = "定时服务";
                                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                                    dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                }

                                                                #endregion

                                                                #region 人员证书



                                                                DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                rowIndex = -1;
                                                                for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                {
                                                                    if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == "75")
                                                                    {
                                                                        rowIndex = i;
                                                                        break;
                                                                    }
                                                                }
                                                                if (rowIndex < 0)
                                                                {
                                                                    row = dt_ryzs.NewRow();
                                                                    dt_ryzs.Rows.Add(row);
                                                                    row["zsjlId"] = dataService.Get_uepp_RyzsNewID();

                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                    row["ryzyzglxID"] = 75;
                                                                    row["ryzyzglx"] = "注册公用设备工程师（给水排水）";
                                                                    row["ryzslxID"] = 751;
                                                                    row["ryzslx"] = "注册公用设备工程师（给水排水）资格证";
                                                                    row["sfzzz"] = 1;
                                                                }
                                                                else
                                                                {
                                                                    row = dt_ryzs.Rows[rowIndex];
                                                                }
                                                                row["zsbh"] = personRegCert.QualCertNo;
                                                                if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                {
                                                                    row["fzrq"] = personRegCert.IssueDate;
                                                                    row["zsyxqrq"] = personRegCert.IssueDate;
                                                                }
                                                                if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                    row["zsyxzrq"] = personRegCert.ValidDate;
                                                                row["fzdw"] = personRegCert.IssueOrgan;

                                                                row["Status"] = personRegCert.Status;
                                                                row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                row["StampNo"] = personRegCert.StampNo;

                                                                row["DataState"] = 0;
                                                                row["tag"] = tag;
                                                                row["xgr"] = "定时服务";
                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                                #endregion

                                                                #region 企业与人员及其执业资格对应关系
                                                                DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, "75");
                                                                if (dt_qyry.Rows.Count == 0)
                                                                {
                                                                    if (personRegCert.Status.ToString2() != "2")
                                                                    {
                                                                        row = dt_qyry.NewRow();
                                                                        dt_qyry.Rows.Add(row);
                                                                        row["ryID"] = personRegCert.IDCardNo;
                                                                        row["qyID"] = personRegCert.CorpCode;
                                                                        row["ryzyzglxID"] = 75;
                                                                        row["ryzyzglx"] = "注册公用设备工程师（给水排水）";
                                                                        row["DataState"] = 0;
                                                                        row["tag"] = tag;
                                                                        row["xgr"] = "定时服务";
                                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                                        dataService.Submit_uepp_qyry(dt_qyry);
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    if (personRegCert.Status.ToString2() == "2")
                                                                    {
                                                                        foreach (DataRow item in dt_qyry.Rows)
                                                                        {
                                                                            item.Delete();
                                                                        }
                                                                        dataService.Submit_uepp_qyry(dt_qyry);
                                                                    }
                                                                }
                                                                #endregion

                                                            }
                                                            else
                                                                if (regType.IndexOf("注册公用设备工程师（动力）") >= 0)
                                                                {
                                                                    #region 执业资格
                                                                    DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                    rowIndex = -1;
                                                                    for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                    {
                                                                        if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == "76")
                                                                        {
                                                                            rowIndex = i;
                                                                            break;
                                                                        }
                                                                    }
                                                                    if (rowIndex < 0)
                                                                    {
                                                                        row = dt_ryzyzg.NewRow();
                                                                        dt_ryzyzg.Rows.Add(row);
                                                                        row["ryID"] = personRegCert.IDCardNo;
                                                                        row["ryzyzglxID"] = 76;
                                                                        row["ryzyzglx"] = "注册公用设备工程师（动力）";
                                                                        row["balxID"] = 1;
                                                                        row["balx"] = "长期备案";

                                                                        row["DataState"] = 0;
                                                                        row["tag"] = tag;
                                                                        row["xgr"] = "定时服务";
                                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                                        dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                    }

                                                                    #endregion

                                                                    #region  人员证书
                                                                    string ryzyzglxID = "76";
                                                                    DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                    rowIndex = -1;
                                                                    for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                    {
                                                                        if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                        {
                                                                            rowIndex = i;
                                                                            break;
                                                                        }
                                                                    }
                                                                    if (rowIndex < 0)
                                                                    {

                                                                        row = dt_ryzs.NewRow();
                                                                        dt_ryzs.Rows.Add(row);
                                                                        row["zsjlId"] = dataService.Get_uepp_RyzsNewID();

                                                                        row["ryID"] = personRegCert.IDCardNo;
                                                                        row["ryzyzglxID"] = ryzyzglxID;
                                                                        row["ryzyzglx"] = "注册公用设备工程师（动力）";
                                                                        row["ryzslxID"] = 761;
                                                                        row["ryzslx"] = "注册公用设备工程师（动力）资格证";
                                                                        row["sfzzz"] = 1;
                                                                    }
                                                                    else
                                                                    {
                                                                        row = dt_ryzs.Rows[rowIndex];
                                                                    }
                                                                    row["zsbh"] = personRegCert.QualCertNo;
                                                                    if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                    {
                                                                        row["fzrq"] = personRegCert.IssueDate;
                                                                        row["zsyxqrq"] = personRegCert.IssueDate;
                                                                    }
                                                                    if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                        row["zsyxzrq"] = personRegCert.ValidDate;
                                                                    row["fzdw"] = personRegCert.IssueOrgan;

                                                                    row["Status"] = personRegCert.Status;
                                                                    row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                    row["StampNo"] = personRegCert.StampNo;

                                                                    row["DataState"] = 0;
                                                                    row["tag"] = tag;
                                                                    row["xgr"] = "定时服务";
                                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                                    dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                                    #endregion

                                                                    #region 企业与人员及其执业资格对应关系
                                                                    DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                    if (dt_qyry.Rows.Count == 0)
                                                                    {
                                                                        if (personRegCert.Status.ToString2() != "2")
                                                                        {
                                                                            row = dt_qyry.NewRow();
                                                                            dt_qyry.Rows.Add(row);
                                                                            row["ryID"] = personRegCert.IDCardNo;
                                                                            row["qyID"] = personRegCert.CorpCode;
                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                            row["ryzyzglx"] = "注册公用设备工程师（动力）";
                                                                            row["DataState"] = 0;
                                                                            row["tag"] = tag;
                                                                            row["xgr"] = "定时服务";
                                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                                            dataService.Submit_uepp_qyry(dt_qyry);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        if (personRegCert.Status.ToString2() == "2")
                                                                        {
                                                                            foreach (DataRow item in dt_qyry.Rows)
                                                                            {
                                                                                item.Delete();
                                                                            }
                                                                            dataService.Submit_uepp_qyry(dt_qyry);
                                                                        }
                                                                    }
                                                                    #endregion

                                                                }
                                                                else
                                                                    if (regType.IndexOf("注册电气工程师（发输变电）") >= 0)
                                                                    {
                                                                        string ryzyzglxID = "77";
                                                                        #region 执业资格
                                                                        DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                        rowIndex = -1;
                                                                        for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                        {
                                                                            if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                            {
                                                                                rowIndex = i;
                                                                                break;
                                                                            }
                                                                        }
                                                                        if (rowIndex < 0)
                                                                        {
                                                                            row = dt_ryzyzg.NewRow();
                                                                            dt_ryzyzg.Rows.Add(row);
                                                                            row["ryID"] = personRegCert.IDCardNo;
                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                            row["ryzyzglx"] = "注册电气工程师（发输变电）";
                                                                            row["balxID"] = 1;
                                                                            row["balx"] = "长期备案";
                                                                            row["DataState"] = 0;
                                                                            row["tag"] = tag;
                                                                            row["xgr"] = "定时服务";
                                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                                            dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                        }

                                                                        #endregion

                                                                        #region 人员证书
                                                                        DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                        rowIndex = -1;
                                                                        for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                        {
                                                                            if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                            {
                                                                                rowIndex = i;
                                                                                break;
                                                                            }
                                                                        }
                                                                        if (rowIndex < 0)
                                                                        {
                                                                            row = dt_ryzs.NewRow();
                                                                            dt_ryzs.Rows.Add(row);
                                                                            row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                            row["ryID"] = personRegCert.IDCardNo;
                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                            row["ryzyzglx"] = "注册电气工程师（发输变电）";

                                                                        }
                                                                        else
                                                                        {
                                                                            row = dt_ryzs.Rows[rowIndex];
                                                                        }
                                                                        row["ryzslxID"] = 771;
                                                                        row["ryzslx"] = "注册电气工程师（发输变电）资格证";
                                                                        row["sfzzz"] = 1;

                                                                        row["zsbh"] = personRegCert.QualCertNo;
                                                                        if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                        {
                                                                            row["fzrq"] = personRegCert.IssueDate;
                                                                            row["zsyxqrq"] = personRegCert.IssueDate;
                                                                        }
                                                                        if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                            row["zsyxzrq"] = personRegCert.ValidDate;
                                                                        row["fzdw"] = personRegCert.IssueOrgan;


                                                                        row["Status"] = personRegCert.Status;
                                                                        row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                        row["StampNo"] = personRegCert.StampNo;

                                                                        row["DataState"] = 0;
                                                                        row["tag"] = tag;
                                                                        row["xgr"] = "定时服务";
                                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                                        dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                                        #endregion

                                                                        #region 企业与人员及其执业资格对应关系
                                                                        DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                        if (dt_qyry.Rows.Count == 0)
                                                                        {
                                                                            if (personRegCert.Status.ToString2() != "2")
                                                                            {
                                                                                row = dt_qyry.NewRow();
                                                                                dt_qyry.Rows.Add(row);
                                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                                row["qyID"] = personRegCert.CorpCode;
                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                row["ryzyzglx"] = "注册电气工程师（发输变电）";
                                                                                row["DataState"] = 0;
                                                                                row["tag"] = tag;
                                                                                row["xgr"] = "定时服务";
                                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                dataService.Submit_uepp_qyry(dt_qyry);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            if (personRegCert.Status.ToString2() == "2")
                                                                            {
                                                                                foreach (DataRow item in dt_qyry.Rows)
                                                                                {
                                                                                    item.Delete();
                                                                                }
                                                                                dataService.Submit_uepp_qyry(dt_qyry);
                                                                            }
                                                                        }
                                                                        #endregion

                                                                    }
                                                                    else
                                                                        if (regType.IndexOf("注册电气工程师（供配电）") >= 0)
                                                                        {
                                                                            string ryzyzglxID = "78";

                                                                            #region 人员执业资格
                                                                            DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                            rowIndex = -1;
                                                                            for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                            {
                                                                                if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                {
                                                                                    rowIndex = i;
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (rowIndex < 0)
                                                                            {
                                                                                row = dt_ryzyzg.NewRow();
                                                                                dt_ryzyzg.Rows.Add(row);
                                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                row["ryzyzglx"] = "注册电气工程师（供配电）";
                                                                                row["balxID"] = 1;
                                                                                row["balx"] = "长期备案";
                                                                                row["DataState"] = 0;
                                                                                row["tag"] = tag;
                                                                                row["xgr"] = "定时服务";
                                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                            }

                                                                            #endregion

                                                                            #region 人员证书
                                                                            DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                            rowIndex = -1;
                                                                            for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                            {
                                                                                if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                {
                                                                                    rowIndex = i;
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (rowIndex < 0)
                                                                            {
                                                                                row = dt_ryzs.NewRow();
                                                                                dt_ryzs.Rows.Add(row);
                                                                                row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                row["ryzyzglx"] = "注册电气工程师（供配电）";
                                                                            }
                                                                            else
                                                                            {
                                                                                row = dt_ryzs.Rows[rowIndex];
                                                                            }
                                                                            row["ryzslxID"] = 781;
                                                                            row["ryzslx"] = "注册电气工程师（供配电）资格证";
                                                                            row["sfzzz"] = 1;
                                                                            row["zsbh"] = personRegCert.QualCertNo;
                                                                            if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                            {
                                                                                row["fzrq"] = personRegCert.IssueDate;
                                                                                row["zsyxqrq"] = personRegCert.IssueDate;
                                                                            }
                                                                            if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                                row["zsyxzrq"] = personRegCert.ValidDate;
                                                                            row["fzdw"] = personRegCert.IssueOrgan;

                                                                            row["Status"] = personRegCert.Status;
                                                                            row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                            row["StampNo"] = personRegCert.StampNo;

                                                                            row["DataState"] = 0;
                                                                            row["tag"] = tag;
                                                                            row["xgr"] = "定时服务";
                                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                                            dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                                            #endregion

                                                                            #region 企业与人员及其执业资格对应关系
                                                                            DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                            if (dt_qyry.Rows.Count == 0)
                                                                            {
                                                                                if (personRegCert.Status.ToString2() != "2")
                                                                                {
                                                                                    row = dt_qyry.NewRow();
                                                                                    dt_qyry.Rows.Add(row);
                                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                                    row["qyID"] = personRegCert.CorpCode;
                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                    row["ryzyzglx"] = "注册电气工程师（供配电）";
                                                                                    row["DataState"] = 0;
                                                                                    row["tag"] = tag;
                                                                                    row["xgr"] = "定时服务";
                                                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                    dataService.Submit_uepp_qyry(dt_qyry);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                if (personRegCert.Status.ToString2() == "2")
                                                                                {
                                                                                    foreach (DataRow item in dt_qyry.Rows)
                                                                                    {
                                                                                        item.Delete();
                                                                                    }
                                                                                    dataService.Submit_uepp_qyry(dt_qyry);
                                                                                }
                                                                            }
                                                                            #endregion

                                                                        }
                                                                        else
                                                                            if (regType.IndexOf("注册建造师") >= 0)
                                                                            {
                                                                                string ryzyzglxID = "1";
                                                                                #region  执业资格

                                                                                DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                                rowIndex = -1;
                                                                                for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                                {
                                                                                    if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                    {
                                                                                        rowIndex = i;
                                                                                        break;
                                                                                    }
                                                                                }
                                                                                if (rowIndex < 0)
                                                                                {
                                                                                    row = dt_ryzyzg.NewRow();
                                                                                    dt_ryzyzg.Rows.Add(row);
                                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                    row["ryzyzglx"] = "注册建造师";
                                                                                    row["balxID"] = 1;
                                                                                    row["balx"] = "长期备案";
                                                                                    row["DataState"] = 0;
                                                                                    row["tag"] = tag;
                                                                                    row["xgr"] = "定时服务";
                                                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                    dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                                }

                                                                                #endregion

                                                                                #region 人员证书

                                                                                DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                                rowIndex = -1;
                                                                                for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                                {
                                                                                    if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                    {
                                                                                        rowIndex = i;
                                                                                        break;
                                                                                    }
                                                                                }
                                                                                if (rowIndex < 0)
                                                                                {
                                                                                    row = dt_ryzs.NewRow();
                                                                                    dt_ryzs.Rows.Add(row);
                                                                                    row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                    row["ryzyzglx"] = "注册建造师";
                                                                                    row["ryzslxID"] = 11;
                                                                                    row["ryzslx"] = "注册建造师资格证";
                                                                                    row["sfzzz"] = 1;

                                                                                }
                                                                                else
                                                                                {
                                                                                    row = dt_ryzs.Rows[rowIndex];
                                                                                }
                                                                                row["zsbh"] = personRegCert.QualCertNo;
                                                                                if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                                {
                                                                                    row["fzrq"] = personRegCert.IssueDate;
                                                                                    row["zsyxqrq"] = personRegCert.IssueDate;
                                                                                }
                                                                                if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                                    row["zsyxzrq"] = personRegCert.ValidDate;
                                                                                row["fzdw"] = personRegCert.IssueOrgan;

                                                                                row["Status"] = personRegCert.Status;
                                                                                row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                                row["StampNo"] = personRegCert.StampNo;

                                                                                row["DataState"] = 0;
                                                                                row["tag"] = tag;
                                                                                row["xgr"] = "定时服务";
                                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                                                #endregion

                                                                                #region 企业与人员及其执业资格对应关系
                                                                                DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                                if (dt_qyry.Rows.Count == 0)
                                                                                {
                                                                                    if (personRegCert.Status.ToString2() != "2")
                                                                                    {
                                                                                        row = dt_qyry.NewRow();
                                                                                        dt_qyry.Rows.Add(row);
                                                                                        row["ryID"] = personRegCert.IDCardNo;
                                                                                        row["qyID"] = personRegCert.CorpCode;
                                                                                        row["ryzyzglxID"] = ryzyzglxID;
                                                                                        row["ryzyzglx"] = "注册建造师";
                                                                                        row["DataState"] = 0;
                                                                                        row["tag"] = tag;
                                                                                        row["xgr"] = "定时服务";
                                                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                        dataService.Submit_uepp_qyry(dt_qyry);
                                                                                    }
                                                                                }
                                                                                else
                                                                                    if (personRegCert.Status.ToString2() == "2")
                                                                                    {
                                                                                        foreach (DataRow item in dt_qyry.Rows)
                                                                                        {
                                                                                            item.Delete();
                                                                                        }
                                                                                        dataService.Submit_uepp_qyry(dt_qyry);
                                                                                    }
                                                                                #endregion

                                                                            }
                                                                            else
                                                                                if (regType.IndexOf("小型项目管理师") >= 0)
                                                                                {
                                                                                    string ryzyzglxID = "2";
                                                                                    #region 执业资格
                                                                                    DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                                    rowIndex = -1;
                                                                                    for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                                    {
                                                                                        if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                        {
                                                                                            rowIndex = i;
                                                                                            break;
                                                                                        }
                                                                                    }
                                                                                    if (rowIndex < 0)
                                                                                    {
                                                                                        row = dt_ryzyzg.NewRow();
                                                                                        dt_ryzyzg.Rows.Add(row);
                                                                                        row["ryID"] = personRegCert.IDCardNo;
                                                                                        row["ryzyzglxID"] = ryzyzglxID;
                                                                                        row["ryzyzglx"] = "小型项目管理师";
                                                                                        row["balxID"] = 1;
                                                                                        row["balx"] = "长期备案";
                                                                                        row["DataState"] = 0;
                                                                                        row["tag"] = tag;
                                                                                        row["xgr"] = "定时服务";
                                                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                        dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                                    }

                                                                                    #endregion

                                                                                    #region 人员证书
                                                                                    DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                                    rowIndex = -1;
                                                                                    for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                                    {
                                                                                        if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                        {
                                                                                            rowIndex = i;
                                                                                            break;
                                                                                        }
                                                                                    }
                                                                                    if (rowIndex < 0)
                                                                                    {
                                                                                        row = dt_ryzs.NewRow();
                                                                                        dt_ryzs.Rows.Add(row);
                                                                                        row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                                        row["ryID"] = personRegCert.IDCardNo;
                                                                                        row["ryzyzglxID"] = ryzyzglxID;
                                                                                        row["ryzyzglx"] = "小型项目管理师";
                                                                                        row["ryzslxID"] = 21;
                                                                                        row["ryzslx"] = "小型项目管理师资格证";
                                                                                        row["sfzzz"] = 1;
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        row = dt_ryzs.Rows[rowIndex];
                                                                                    }
                                                                                    row["zsbh"] = personRegCert.QualCertNo;
                                                                                    if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                                    {
                                                                                        row["fzrq"] = personRegCert.IssueDate;
                                                                                        row["zsyxqrq"] = personRegCert.IssueDate;
                                                                                    }
                                                                                    if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                                        row["zsyxzrq"] = personRegCert.ValidDate;
                                                                                    row["fzdw"] = personRegCert.IssueOrgan;


                                                                                    row["Status"] = personRegCert.Status;
                                                                                    row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                                    row["StampNo"] = personRegCert.StampNo;

                                                                                    row["DataState"] = 0;
                                                                                    row["tag"] = tag;
                                                                                    row["xgr"] = "定时服务";
                                                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                    dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                                                    #endregion

                                                                                    #region 企业与人员及其执业资格对应关系
                                                                                    DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                                    if (dt_qyry.Rows.Count == 0)
                                                                                    {
                                                                                        if (personRegCert.Status.ToString2() != "2")
                                                                                        {
                                                                                            row = dt_qyry.NewRow();
                                                                                            dt_qyry.Rows.Add(row);
                                                                                            row["ryID"] = personRegCert.IDCardNo;
                                                                                            row["qyID"] = personRegCert.CorpCode;
                                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                                            row["ryzyzglx"] = "小型项目管理师";
                                                                                            row["DataState"] = 0;
                                                                                            row["tag"] = tag;
                                                                                            row["xgr"] = "定时服务";
                                                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                            dataService.Submit_uepp_qyry(dt_qyry);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                        if (personRegCert.Status.ToString2() == "2")
                                                                                        {
                                                                                            foreach (DataRow item in dt_qyry.Rows)
                                                                                            {
                                                                                                item.Delete();
                                                                                            }
                                                                                            dataService.Submit_uepp_qyry(dt_qyry);
                                                                                        }
                                                                                    #endregion

                                                                                }
                                                                                else
                                                                                    if (regType.IndexOf("注册造价工程师") >= 0)
                                                                                    {
                                                                                        string ryzyzglxID = "41";

                                                                                        #region 执业资格
                                                                                        DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                                        rowIndex = -1;
                                                                                        for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                                        {
                                                                                            if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                            {
                                                                                                rowIndex = i;
                                                                                                break;
                                                                                            }
                                                                                        }
                                                                                        if (rowIndex < 0)
                                                                                        {
                                                                                            row = dt_ryzyzg.NewRow();
                                                                                            dt_ryzyzg.Rows.Add(row);
                                                                                            row["ryID"] = personRegCert.IDCardNo;
                                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                                            row["ryzyzglx"] = "注册造价工程师";
                                                                                            row["balxID"] = 1;
                                                                                            row["balx"] = "长期备案";
                                                                                            row["DataState"] = 0;
                                                                                            row["tag"] = tag;
                                                                                            row["xgr"] = "定时服务";

                                                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                            dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                                        }

                                                                                        #endregion

                                                                                        #region 人员证书

                                                                                        DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                                        rowIndex = -1;
                                                                                        for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                                        {
                                                                                            if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                            {
                                                                                                rowIndex = i;
                                                                                                break;
                                                                                            }
                                                                                        }
                                                                                        if (rowIndex < 0)
                                                                                        {

                                                                                            row = dt_ryzs.NewRow();
                                                                                            dt_ryzs.Rows.Add(row);

                                                                                            row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                                            row["ryID"] = personRegCert.IDCardNo;
                                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                                            row["ryzyzglx"] = "注册造价工程师";
                                                                                            row["ryzslxID"] = 131;
                                                                                            row["ryzslx"] = "注册造价师资格证";


                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            row = dt_ryzs.Rows[rowIndex];
                                                                                        }
                                                                                        row["sfzzz"] = 1;
                                                                                        row["zsbh"] = personRegCert.QualCertNo;
                                                                                        if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                                        {
                                                                                            row["fzrq"] = personRegCert.IssueDate;
                                                                                            row["zsyxqrq"] = personRegCert.IssueDate;
                                                                                        }
                                                                                        if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                                            row["zsyxzrq"] = personRegCert.ValidDate;
                                                                                        row["fzdw"] = personRegCert.IssueOrgan;

                                                                                        row["Status"] = personRegCert.Status;
                                                                                        row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                                        row["StampNo"] = personRegCert.StampNo;

                                                                                        row["DataState"] = 0;
                                                                                        row["tag"] = tag;
                                                                                        row["xgr"] = "定时服务";
                                                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                        dataService.Submit_uepp_Ryzs(dt_ryzs);
                                                                                        #endregion

                                                                                        #region 企业与人员及其执业资格对应关系
                                                                                        DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                                        if (dt_qyry.Rows.Count == 0)
                                                                                        {
                                                                                            if (personRegCert.Status.ToString2() != "2")
                                                                                            {
                                                                                                row = dt_qyry.NewRow();
                                                                                                dt_qyry.Rows.Add(row);
                                                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                                                row["qyID"] = personRegCert.CorpCode;
                                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                                row["ryzyzglx"] = "注册造价工程师";
                                                                                                row["DataState"] = 0;
                                                                                                row["tag"] = tag;
                                                                                                row["xgr"] = "定时服务";
                                                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                dataService.Submit_uepp_qyry(dt_qyry);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                            if (personRegCert.Status.ToString2() == "2")
                                                                                            {
                                                                                                foreach (DataRow item in dt_qyry.Rows)
                                                                                                {
                                                                                                    item.Delete();
                                                                                                }
                                                                                                dataService.Submit_uepp_qyry(dt_qyry);
                                                                                            }
                                                                                        #endregion
                                                                                    }
                                                                                    else
                                                                                        if (regType.IndexOf("注册监理工程师") >= 0)
                                                                                        {
                                                                                            string ryzyzglxID = "21";

                                                                                            #region 执业资格
                                                                                            DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                                            rowIndex = -1;
                                                                                            for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                                            {
                                                                                                if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                {
                                                                                                    rowIndex = i;
                                                                                                    break;
                                                                                                }
                                                                                            }
                                                                                            if (rowIndex < 0)
                                                                                            {
                                                                                                row = dt_ryzyzg.NewRow();
                                                                                                dt_ryzyzg.Rows.Add(row);
                                                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                                row["ryzyzglx"] = "注册监理工程师";
                                                                                                row["balxID"] = 1;
                                                                                                row["balx"] = "长期备案";
                                                                                                row["DataState"] = 0;
                                                                                                row["tag"] = tag;
                                                                                                row["xgr"] = "定时服务";
                                                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                                            }

                                                                                            #endregion

                                                                                            #region  人员证书
                                                                                            DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                                            rowIndex = -1;
                                                                                            for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                                            {
                                                                                                if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                {
                                                                                                    rowIndex = i;
                                                                                                    break;
                                                                                                }
                                                                                            }
                                                                                            if (rowIndex < 0)
                                                                                            {

                                                                                                row = dt_ryzs.NewRow();
                                                                                                dt_ryzs.Rows.Add(row);
                                                                                                row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                                row["ryzyzglx"] = "注册监理工程师";
                                                                                                row["ryzslxID"] = 91;
                                                                                                row["ryzslx"] = "注册监理师资格证";


                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                row = dt_ryzs.Rows[rowIndex];
                                                                                            }

                                                                                            row["sfzzz"] = 1;
                                                                                            row["zsbh"] = personRegCert.QualCertNo;

                                                                                            if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                                            {
                                                                                                row["fzrq"] = personRegCert.IssueDate;
                                                                                                row["zsyxqrq"] = personRegCert.IssueDate;
                                                                                            }
                                                                                            if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                                                row["zsyxzrq"] = personRegCert.ValidDate;
                                                                                            row["fzdw"] = personRegCert.IssueOrgan;

                                                                                            row["Status"] = personRegCert.Status;
                                                                                            row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                                            row["StampNo"] = personRegCert.StampNo;

                                                                                            row["DataState"] = 0;
                                                                                            row["tag"] = tag;
                                                                                            row["xgr"] = "定时服务";
                                                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                            dataService.Submit_uepp_Ryzs(dt_ryzs);
                                                                                            #endregion

                                                                                            #region 企业与人员及其执业资格对应关系
                                                                                            DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                                            if (dt_qyry.Rows.Count == 0)
                                                                                            {
                                                                                                if (personRegCert.Status.ToString2() != "2")
                                                                                                {
                                                                                                    row = dt_qyry.NewRow();
                                                                                                    dt_qyry.Rows.Add(row);
                                                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                                                    row["qyID"] = personRegCert.CorpCode;
                                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                                    row["ryzyzglx"] = "注册监理工程师";
                                                                                                    row["DataState"] = 0;
                                                                                                    row["tag"] = tag;
                                                                                                    row["xgr"] = "定时服务";
                                                                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                    dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                                if (personRegCert.Status.ToString2() == "2")
                                                                                                {
                                                                                                    foreach (DataRow item in dt_qyry.Rows)
                                                                                                    {
                                                                                                        item.Delete();
                                                                                                    }
                                                                                                    dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                }
                                                                                            #endregion


                                                                                        }
                                                                                        else
                                                                                            if (regType.IndexOf("注册城市规划师") >= 0)
                                                                                            {
                                                                                                #region 执业资格
                                                                                                string ryzyzglxID = "79";
                                                                                                DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                                                rowIndex = -1;
                                                                                                for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                                                {
                                                                                                    if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                    {
                                                                                                        rowIndex = i;
                                                                                                        break;
                                                                                                    }
                                                                                                }
                                                                                                if (rowIndex < 0)
                                                                                                {
                                                                                                    row = dt_ryzyzg.NewRow();
                                                                                                    dt_ryzyzg.Rows.Add(row);
                                                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                                    row["ryzyzglx"] = "注册城市规划师";
                                                                                                    row["balxID"] = 1;
                                                                                                    row["balx"] = "长期备案";
                                                                                                    row["DataState"] = 0;
                                                                                                    row["tag"] = tag;
                                                                                                    row["xgr"] = "定时服务";
                                                                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                    dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                                                }


                                                                                                #endregion

                                                                                                #region 人员证书
                                                                                                DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                                                rowIndex = -1;
                                                                                                for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                                                {
                                                                                                    if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                    {
                                                                                                        rowIndex = i;
                                                                                                        break;
                                                                                                    }
                                                                                                }
                                                                                                if (rowIndex < 0)
                                                                                                {
                                                                                                    row = dt_ryzs.NewRow();
                                                                                                    dt_ryzs.Rows.Add(row);
                                                                                                    row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                                    row["ryzyzglx"] = "注册城市规划师";
                                                                                                    row["ryzslxID"] = 791;
                                                                                                    row["ryzslx"] = "注册城市规划师资格证";
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    row = dt_ryzs.Rows[rowIndex];
                                                                                                }
                                                                                                row["sfzzz"] = 1;
                                                                                                row["zsbh"] = personRegCert.QualCertNo;

                                                                                                if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                                                {
                                                                                                    row["zsyxqrq"] = personRegCert.IssueDate;
                                                                                                    row["fzrq"] = personRegCert.IssueDate;

                                                                                                }
                                                                                                if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                                                    row["zsyxzrq"] = personRegCert.ValidDate;
                                                                                                row["fzdw"] = personRegCert.IssueOrgan;
                                                                                                row["Status"] = personRegCert.Status;
                                                                                                row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                                                row["StampNo"] = personRegCert.StampNo;

                                                                                                row["DataState"] = 0;
                                                                                                row["tag"] = tag;
                                                                                                row["xgr"] = "定时服务";
                                                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                                                                #endregion

                                                                                                #region 企业与人员及其执业资格对应关系
                                                                                                DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                                                if (dt_qyry.Rows.Count == 0)
                                                                                                {
                                                                                                    if (personRegCert.Status.ToString2() != "2")
                                                                                                    {
                                                                                                        row = dt_qyry.NewRow();
                                                                                                        dt_qyry.Rows.Add(row);
                                                                                                        row["ryID"] = personRegCert.IDCardNo;
                                                                                                        row["qyID"] = personRegCert.CorpCode;
                                                                                                        row["ryzyzglxID"] = ryzyzglxID;
                                                                                                        row["ryzyzglx"] = "注册城市规划师";
                                                                                                        row["DataState"] = 0;
                                                                                                        row["tag"] = tag;
                                                                                                        row["xgr"] = "定时服务";
                                                                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                        dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                    }
                                                                                                }
                                                                                                else
                                                                                                    if (personRegCert.Status.ToString2() == "2")
                                                                                                    {
                                                                                                        foreach (DataRow item in dt_qyry.Rows)
                                                                                                        {
                                                                                                            item.Delete();
                                                                                                        }
                                                                                                        dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                    }
                                                                                                #endregion

                                                                                            }
                                                                                            else
                                                                                                if (regType.IndexOf("注册化工工程师") >= 0)
                                                                                                {
                                                                                                    string ryzyzglxID = "79";

                                                                                                    #region 执业资格
                                                                                                    DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                                                    rowIndex = -1;
                                                                                                    for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                                                    {
                                                                                                        if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                        {
                                                                                                            rowIndex = i;
                                                                                                            break;
                                                                                                        }
                                                                                                    }
                                                                                                    if (rowIndex < 0)
                                                                                                    {
                                                                                                        row = dt_ryzyzg.NewRow();
                                                                                                        dt_ryzyzg.Rows.Add(row);
                                                                                                        row["ryID"] = personRegCert.IDCardNo;
                                                                                                        row["ryzyzglxID"] = ryzyzglxID;
                                                                                                        row["ryzyzglx"] = "注册化工工程师";
                                                                                                        row["balxID"] = 1;
                                                                                                        row["balx"] = "长期备案";
                                                                                                        row["DataState"] = 0;
                                                                                                        row["tag"] = tag;
                                                                                                        row["xgr"] = "定时服务";
                                                                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                        dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                                                    }
                                                                                                    #endregion

                                                                                                    #region 人员证书
                                                                                                    DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                                                    rowIndex = -1;
                                                                                                    for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                                                    {
                                                                                                        if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                        {
                                                                                                            rowIndex = i;
                                                                                                            break;
                                                                                                        }
                                                                                                    }
                                                                                                    if (rowIndex < 0)
                                                                                                    {
                                                                                                        row = dt_ryzs.NewRow();
                                                                                                        dt_ryzs.Rows.Add(row);
                                                                                                        row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                                                        row["ryID"] = personRegCert.IDCardNo;
                                                                                                        row["ryzyzglxID"] = ryzyzglxID;
                                                                                                        row["ryzyzglx"] = "注册化工工程师";
                                                                                                        row["ryzslxID"] = 801;
                                                                                                        row["ryzslx"] = "注册化工工程师资格证";
                                                                                                        row["sfzzz"] = 1;
                                                                                                        row["zsbh"] = personRegCert.QualCertNo;
                                                                                                        if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                                                        {
                                                                                                            row["zsyxqrq"] = personRegCert.IssueDate;
                                                                                                            row["fzrq"] = personRegCert.IssueDate;
                                                                                                        }
                                                                                                        if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                                                            row["zsyxzrq"] = personRegCert.ValidDate;
                                                                                                        row["fzdw"] = personRegCert.IssueOrgan;
                                                                                                        row["Status"] = personRegCert.Status;
                                                                                                        row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                                                        row["StampNo"] = personRegCert.StampNo;


                                                                                                        row["DataState"] = 0;
                                                                                                        row["tag"] = tag;
                                                                                                        row["xgr"] = "定时服务";
                                                                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                        dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                                                                    }
                                                                                                    else
                                                                                                        if (personRegCert.Status.ToString2() != "1")
                                                                                                        {
                                                                                                            dt_ryzs.Rows[rowIndex].Delete();
                                                                                                            dataService.Submit_uepp_Ryzs(dt_ryzs);
                                                                                                        }

                                                                                                    #endregion

                                                                                                    #region 企业与人员及其执业资格对应关系
                                                                                                    DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                                                    if (dt_qyry.Rows.Count == 0)
                                                                                                    {
                                                                                                        if (personRegCert.Status.ToString2() != "2")
                                                                                                        {
                                                                                                            row = dt_qyry.NewRow();
                                                                                                            dt_qyry.Rows.Add(row);
                                                                                                            row["ryID"] = personRegCert.IDCardNo;
                                                                                                            row["qyID"] = personRegCert.CorpCode;
                                                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                                                            row["ryzyzglx"] = "注册化工工程师";
                                                                                                            row["DataState"] = 0;
                                                                                                            row["tag"] = tag;
                                                                                                            row["xgr"] = "定时服务";
                                                                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                            dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                        }
                                                                                                    }
                                                                                                    else
                                                                                                        if (personRegCert.Status.ToString2() == "2")
                                                                                                        {
                                                                                                            foreach (DataRow item in dt_qyry.Rows)
                                                                                                            {
                                                                                                                item.Delete();
                                                                                                            }
                                                                                                            dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                        }

                                                                                                    #endregion

                                                                                                }
                                                                                                else
                                                                                                    if (regType.IndexOf("注册房地产估价师") >= 0)
                                                                                                    {
                                                                                                        string ryzyzglxID = "81";

                                                                                                        #region 执业资格

                                                                                                        DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                                                        rowIndex = -1;
                                                                                                        for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                                                        {
                                                                                                            if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                            {
                                                                                                                rowIndex = i;
                                                                                                                break;
                                                                                                            }
                                                                                                        }
                                                                                                        if (rowIndex < 0)
                                                                                                        {
                                                                                                            row = dt_ryzyzg.NewRow();
                                                                                                            dt_ryzyzg.Rows.Add(row);
                                                                                                            row["ryID"] = personRegCert.IDCardNo;
                                                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                                                            row["ryzyzglx"] = "注册房地产估价师";
                                                                                                            row["balxID"] = 1;
                                                                                                            row["balx"] = "长期备案";

                                                                                                            row["DataState"] = 0;
                                                                                                            row["tag"] = tag;
                                                                                                            row["xgr"] = "定时服务";
                                                                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                            dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                                                        }
                                                                                                        #endregion

                                                                                                        #region 人员证书
                                                                                                        DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                                                        rowIndex = -1;
                                                                                                        for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                                                        {
                                                                                                            if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                            {
                                                                                                                rowIndex = i;
                                                                                                                break;
                                                                                                            }
                                                                                                        }
                                                                                                        if (rowIndex < 0)
                                                                                                        {

                                                                                                            row = dt_ryzs.NewRow();
                                                                                                            dt_ryzs.Rows.Add(row);
                                                                                                            row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                                                            row["ryID"] = personRegCert.IDCardNo;
                                                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                                                            row["ryzyzglx"] = "注册房地产估价师";
                                                                                                            row["ryzslxID"] = 811;
                                                                                                            row["ryzslx"] = "注册房地产估价师资格证";

                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            row = dt_ryzs.Rows[rowIndex];
                                                                                                        }

                                                                                                        row["sfzzz"] = 1;
                                                                                                        row["zsbh"] = personRegCert.QualCertNo;
                                                                                                        if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                                                        {
                                                                                                            row["zsyxqrq"] = personRegCert.IssueDate;
                                                                                                            row["fzrq"] = personRegCert.IssueDate;
                                                                                                        }
                                                                                                        if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                                                            row["zsyxzrq"] = personRegCert.ValidDate;
                                                                                                        row["fzdw"] = personRegCert.IssueOrgan;
                                                                                                        row["Status"] = personRegCert.Status;
                                                                                                        row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                                                        row["StampNo"] = personRegCert.StampNo;

                                                                                                        row["DataState"] = 0;
                                                                                                        row["tag"] = tag;
                                                                                                        row["xgr"] = "定时服务";
                                                                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                        dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                                                                        #endregion

                                                                                                        #region 企业与人员及其执业资格对应关系
                                                                                                        DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                                                        if (dt_qyry.Rows.Count == 0)
                                                                                                        {
                                                                                                            if (personRegCert.Status.ToString2() != "2")
                                                                                                            {
                                                                                                                row = dt_qyry.NewRow();
                                                                                                                dt_qyry.Rows.Add(row);
                                                                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                                                                row["qyID"] = personRegCert.CorpCode;
                                                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                                                row["ryzyzglx"] = "注册房地产估价师";
                                                                                                                row["DataState"] = 0;
                                                                                                                row["tag"] = tag;
                                                                                                                row["xgr"] = "定时服务";
                                                                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                                dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                            }
                                                                                                        }
                                                                                                        else
                                                                                                            if (personRegCert.Status.ToString2() == "2")
                                                                                                            {
                                                                                                                foreach (DataRow item in dt_qyry.Rows)
                                                                                                                {
                                                                                                                    item.Delete();
                                                                                                                }
                                                                                                                dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                            }

                                                                                                        #endregion
                                                                                                    }
                                                                                                    else
                                                                                                        if (regType.IndexOf("注册房地产经纪人") >= 0)
                                                                                                        {
                                                                                                            string ryzyzglxID = "82";

                                                                                                            #region 执业资格
                                                                                                            DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                                                            rowIndex = -1;
                                                                                                            for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                                                            {
                                                                                                                if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                                {
                                                                                                                    rowIndex = i;
                                                                                                                    break;
                                                                                                                }
                                                                                                            }
                                                                                                            if (rowIndex < 0)
                                                                                                            {
                                                                                                                row = dt_ryzyzg.NewRow();
                                                                                                                dt_ryzyzg.Rows.Add(row);
                                                                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                                                row["ryzyzglx"] = "注册房地产经纪人";
                                                                                                                row["balxID"] = 1;
                                                                                                                row["balx"] = "长期备案";
                                                                                                                row["DataState"] = 0;
                                                                                                                row["tag"] = tag;
                                                                                                                row["xgr"] = "定时服务";
                                                                                                                if (string.IsNullOrEmpty(personRegCert.UpdateDate))
                                                                                                                    personRegCert.UpdateDate = DateTime.Now.ToString("yyyy-MM-dd");
                                                                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                                dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                                                            }
                                                                                                            #endregion

                                                                                                            #region 人员证书
                                                                                                            DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                                                            rowIndex = -1;
                                                                                                            for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                                                            {
                                                                                                                if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                                {
                                                                                                                    rowIndex = i;
                                                                                                                    break;
                                                                                                                }
                                                                                                            }
                                                                                                            if (rowIndex < 0)
                                                                                                            {

                                                                                                                row = dt_ryzs.NewRow();
                                                                                                                dt_ryzs.Rows.Add(row);
                                                                                                                row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                                                                row["ryID"] = personRegCert.IDCardNo;
                                                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                                                row["ryzyzglx"] = "注册房地产经纪人";
                                                                                                                row["ryzslxID"] = 821;
                                                                                                                row["ryzslx"] = "注册房地产经纪人资格证";


                                                                                                            }
                                                                                                            else
                                                                                                            {
                                                                                                                row = dt_ryzs.Rows[rowIndex];
                                                                                                            }

                                                                                                            row["sfzzz"] = 1;
                                                                                                            row["zsbh"] = personRegCert.QualCertNo;
                                                                                                            if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                                                            {
                                                                                                                row["zsyxqrq"] = personRegCert.IssueDate;
                                                                                                                row["fzrq"] = personRegCert.IssueDate;
                                                                                                            }
                                                                                                            if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                                                                row["zsyxzrq"] = personRegCert.ValidDate;
                                                                                                            row["fzdw"] = personRegCert.IssueOrgan;
                                                                                                            row["Status"] = personRegCert.Status;
                                                                                                            row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                                                            row["StampNo"] = personRegCert.StampNo;


                                                                                                            row["DataState"] = 0;
                                                                                                            row["tag"] = tag;
                                                                                                            row["xgr"] = "定时服务";
                                                                                                            row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                            dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                                                                            #endregion

                                                                                                            #region 企业与人员及其执业资格对应关系
                                                                                                            DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                                                            if (dt_qyry.Rows.Count == 0)
                                                                                                            {
                                                                                                                if (personRegCert.Status.ToString2() != "2")
                                                                                                                {
                                                                                                                    row = dt_qyry.NewRow();
                                                                                                                    dt_qyry.Rows.Add(row);
                                                                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                                                                    row["qyID"] = personRegCert.CorpCode;
                                                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                                                    row["ryzyzglx"] = "注册房地产经纪人";
                                                                                                                    row["DataState"] = 0;
                                                                                                                    row["tag"] = tag;
                                                                                                                    row["xgr"] = "定时服务";
                                                                                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                                    dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                                }
                                                                                                            }
                                                                                                            else
                                                                                                                if (personRegCert.Status.ToString2() == "2")
                                                                                                                {
                                                                                                                    foreach (DataRow item in dt_qyry.Rows)
                                                                                                                    {
                                                                                                                        item.Delete();
                                                                                                                    }
                                                                                                                    dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                                }

                                                                                                            #endregion

                                                                                                        }
                                                                                                        else
                                                                                                            if (regType.IndexOf("物业管理师") >= 0)
                                                                                                            {
                                                                                                                string ryzyzglxID = "83";

                                                                                                                #region 执业资格
                                                                                                                DataTable dt_ryzyzg = dataService.Get_uepp_Ryzyzg(personRegCert.IDCardNo);
                                                                                                                rowIndex = -1;
                                                                                                                for (int i = 0; i < dt_ryzyzg.Rows.Count; i++)
                                                                                                                {
                                                                                                                    if (dt_ryzyzg.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                                    {
                                                                                                                        rowIndex = i;
                                                                                                                        break;
                                                                                                                    }
                                                                                                                }
                                                                                                                if (rowIndex < 0)
                                                                                                                {
                                                                                                                    row = dt_ryzyzg.NewRow();
                                                                                                                    dt_ryzyzg.Rows.Add(row);
                                                                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                                                    row["ryzyzglx"] = "物业管理师";
                                                                                                                    row["balxID"] = 1;
                                                                                                                    row["balx"] = "长期备案";
                                                                                                                    row["DataState"] = 0;
                                                                                                                    row["tag"] = tag;
                                                                                                                    row["xgr"] = "定时服务";
                                                                                                                    row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                                    dataService.Submit_uepp_Ryzyzg(dt_ryzyzg);
                                                                                                                }
                                                                                                                #endregion

                                                                                                                #region 人员证书
                                                                                                                DataTable dt_ryzs = dataService.Get_uepp_Ryzs(personRegCert.IDCardNo);
                                                                                                                rowIndex = -1;
                                                                                                                for (int i = 0; i < dt_ryzs.Rows.Count; i++)
                                                                                                                {
                                                                                                                    if (dt_ryzs.Rows[i]["ryzyzglxid"].ToString2() == ryzyzglxID)
                                                                                                                    {
                                                                                                                        rowIndex = i;
                                                                                                                        break;
                                                                                                                    }
                                                                                                                }
                                                                                                                if (rowIndex < 0)
                                                                                                                {
                                                                                                                    row = dt_ryzs.NewRow();
                                                                                                                    dt_ryzs.Rows.Add(row);
                                                                                                                    row["zsjlId"] = dataService.Get_uepp_RyzsNewID();
                                                                                                                    row["ryID"] = personRegCert.IDCardNo;
                                                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                                                    row["ryzyzglx"] = "物业管理师";
                                                                                                                    row["ryzslxID"] = 831;
                                                                                                                    row["ryzslx"] = "物业管理师资格证";
                                                                                                                }
                                                                                                                else
                                                                                                                {
                                                                                                                    row = dt_ryzs.Rows[rowIndex];
                                                                                                                }
                                                                                                                row["sfzzz"] = 1;
                                                                                                                row["zsbh"] = personRegCert.QualCertNo;

                                                                                                                if (!string.IsNullOrEmpty(personRegCert.IssueDate))
                                                                                                                {
                                                                                                                    row["fzrq"] = personRegCert.IssueDate;
                                                                                                                    row["zsyxqrq"] = personRegCert.IssueDate;
                                                                                                                }
                                                                                                                if (!string.IsNullOrEmpty(personRegCert.ValidDate))
                                                                                                                    row["zsyxzrq"] = personRegCert.ValidDate;
                                                                                                                row["fzdw"] = personRegCert.IssueOrgan;
                                                                                                                row["Status"] = personRegCert.Status;
                                                                                                                row["QualIssueDate"] = personRegCert.QualIssueDate;
                                                                                                                row["StampNo"] = personRegCert.StampNo;
                                                                                                                row["DataState"] = 0;
                                                                                                                row["tag"] = tag;
                                                                                                                row["xgr"] = "定时服务";
                                                                                                                row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                                dataService.Submit_uepp_Ryzs(dt_ryzs);

                                                                                                                #endregion

                                                                                                                #region 企业与人员及其执业资格对应关系
                                                                                                                DataTable dt_qyry = dataService.Get_uepp_Qyry(personRegCert.IDCardNo, personRegCert.CorpCode, ryzyzglxID);
                                                                                                                if (dt_qyry.Rows.Count == 0)
                                                                                                                {
                                                                                                                    if (personRegCert.Status.ToString2() != "2")
                                                                                                                    {
                                                                                                                        row = dt_qyry.NewRow();
                                                                                                                        dt_qyry.Rows.Add(row);
                                                                                                                        row["ryID"] = personRegCert.IDCardNo;
                                                                                                                        row["qyID"] = personRegCert.CorpCode;
                                                                                                                        row["ryzyzglxID"] = ryzyzglxID;
                                                                                                                        row["ryzyzglx"] = "物业管理师";
                                                                                                                        row["DataState"] = 0;
                                                                                                                        row["tag"] = tag;
                                                                                                                        row["xgr"] = "定时服务";
                                                                                                                        row["xgrqsj"] = personRegCert.UpdateDate;
                                                                                                                        dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                                    }
                                                                                                                }
                                                                                                                else
                                                                                                                    if (personRegCert.Status.ToString2() == "2")
                                                                                                                    {
                                                                                                                        foreach (DataRow item in dt_qyry.Rows)
                                                                                                                        {
                                                                                                                            item.Delete();
                                                                                                                        }
                                                                                                                        dataService.Submit_uepp_qyry(dt_qyry);
                                                                                                                    }

                                                                                                                #endregion
                                                                                                            }
                                                                                                            else
                                                                                                            {

                                                                                                            }


                                    }
                                    catch (Exception ex)
                                    {
                                        Public.WriteLog("更新人员证书出现异常，ryID：" + personRegCert.IDCardNo + ",Exception:" + ex.Message);
                                    }
                                }
                            }

                            #endregion

                            #region 人员专业明细
                            if (personRegMajorBody != null)
                            {
                                foreach (PersonRegMajor personRegMajort in personRegMajorBody.array)
                                {
                                    try
                                    {
                                        if (string.IsNullOrEmpty(personRegMajort.UpdateDate))
                                            personRegMajort.UpdateDate = DateTime.Now.ToString("yyyy-MM-dd");
                                        DataTable dt_ryzymx = dataService.Get_uepp_Ryzymx(personRegMajort.IDCardNo);
                                        int rowIndex = -1;
                                        string regType = personRegMajort.RegType;

                                        if (regType.IndexOf("注册建筑师") >= 0)
                                        {
                                            #region  注册建筑师
                                            for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                            {
                                                if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == "51")
                                                {
                                                    rowIndex = i;
                                                    break;
                                                }
                                            }
                                            if (rowIndex < 0)
                                            {
                                                row = dt_ryzymx.NewRow();
                                                dt_ryzymx.Rows.Add(row);
                                                row["ryID"] = personRegMajort.IDCardNo;
                                                row["ryzyzglxID"] = 51;
                                                row["ryzyzglx"] = "注册建筑师";
                                            }
                                            else
                                            {
                                                row = dt_ryzymx.Rows[rowIndex];
                                            }
                                            if (regType.IndexOf("一级") >= 0)
                                            {
                                                row["zyzgdjID"] = 21;
                                                row["zyzgdj"] = "壹级";
                                            }
                                            else
                                            {
                                                row["zyzgdjID"] = 22;
                                                row["zyzgdj"] = "贰级";
                                            }
                                            row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                            row["DataState"] = 0;
                                            row["tag"] = tag;
                                            row["xgr"] = "定时服务";
                                            row["xgrqsj"] = personRegMajort.UpdateDate;
                                            dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                            #endregion
                                        }
                                        else
                                            if (regType.IndexOf("注册结构工程师") >= 0)
                                            {
                                                #region  注册结构工程师

                                                for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                {
                                                    if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == "61")
                                                    {
                                                        rowIndex = i;
                                                        break;
                                                    }
                                                }
                                                if (rowIndex < 0)
                                                {
                                                    row = dt_ryzymx.NewRow();
                                                    dt_ryzymx.Rows.Add(row);
                                                    row["ryID"] = personRegMajort.IDCardNo;
                                                    row["ryzyzglxID"] = 61;
                                                    row["ryzyzglx"] = "注册结构师";
                                                }
                                                else
                                                {
                                                    row = dt_ryzymx.Rows[rowIndex];
                                                }
                                                if (regType.IndexOf("一级") >= 0)
                                                {
                                                    row["zyzgdjID"] = 26;
                                                    row["zyzgdj"] = "壹级";
                                                }
                                                else
                                                {
                                                    row["zyzgdjID"] = 27;
                                                    row["zyzgdj"] = "贰级";
                                                }

                                                row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                row["DataState"] = 0;
                                                row["tag"] = tag;
                                                row["xgr"] = "定时服务";
                                                row["xgrqsj"] = personRegMajort.UpdateDate;
                                                dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                #endregion
                                            }
                                            else
                                                if (regType.IndexOf("注册土木工程师（岩土）") >= 0)
                                                {
                                                    #region 注册土木工程师（岩土）
                                                    rowIndex = -1;
                                                    for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                    {
                                                        if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == "73")
                                                        {
                                                            rowIndex = i;
                                                            break;
                                                        }
                                                    }
                                                    if (rowIndex < 0)
                                                    {
                                                        row = dt_ryzymx.NewRow();
                                                        dt_ryzymx.Rows.Add(row);
                                                        row["ryID"] = personRegMajort.IDCardNo;
                                                        row["ryzyzglxID"] = 73;
                                                        row["ryzyzglx"] = "注册土木工程师（岩土）";

                                                    }
                                                    else
                                                    {
                                                        row = dt_ryzymx.Rows[rowIndex];
                                                    }
                                                    row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                    row["DataState"] = 0;
                                                    row["tag"] = tag;
                                                    row["xgr"] = "定时服务";
                                                    row["xgrqsj"] = personRegMajort.UpdateDate;
                                                    dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                    #endregion

                                                }
                                                else
                                                    if (regType.IndexOf("注册土木工程师（港口与航道工程）") >= 0)
                                                    {
                                                        #region 注册土木工程师（港口与航道工程）
                                                        rowIndex = -1;
                                                        for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                        {
                                                            if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == "84")
                                                            {
                                                                rowIndex = i;
                                                                break;
                                                            }
                                                        }
                                                        if (rowIndex < 0)
                                                        {
                                                            row = dt_ryzymx.NewRow();
                                                            dt_ryzymx.Rows.Add(row);
                                                            row["ryID"] = personRegMajort.IDCardNo;
                                                            row["ryzyzglxID"] = 84;
                                                            row["ryzyzglx"] = "注册土木工程师（港口与航道工程）";
                                                        }
                                                        else
                                                        {
                                                            row = dt_ryzymx.Rows[rowIndex];
                                                        }
                                                        row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                        row["DataState"] = 0;
                                                        row["tag"] = tag;
                                                        row["xgr"] = "定时服务";
                                                        row["xgrqsj"] = personRegMajort.UpdateDate;
                                                        dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                        #endregion
                                                    }
                                                    else
                                                        if (regType.IndexOf("注册公用设备工程师（暖通空调）") >= 0)
                                                        {
                                                            #region 注册公用设备工程师（暖通空调）
                                                            rowIndex = -1;
                                                            for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                            {
                                                                if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == "74")
                                                                {
                                                                    rowIndex = i;
                                                                    break;
                                                                }
                                                            }
                                                            if (rowIndex < 0)
                                                            {
                                                                row = dt_ryzymx.NewRow();
                                                                dt_ryzymx.Rows.Add(row);
                                                                row["ryID"] = personRegMajort.IDCardNo;
                                                                row["ryzyzglxID"] = 74;
                                                                row["ryzyzglx"] = "注册公用设备工程师（暖通空调）";


                                                            }
                                                            else
                                                            {
                                                                row = dt_ryzymx.Rows[rowIndex];
                                                            }
                                                            row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                            row["DataState"] = 0;
                                                            row["tag"] = tag;
                                                            row["xgr"] = "定时服务";
                                                            row["xgrqsj"] = personRegMajort.UpdateDate;
                                                            dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                            #endregion

                                                        }
                                                        else
                                                            if (regType.IndexOf("注册公用设备工程师（给水排水）") >= 0)
                                                            {
                                                                #region 注册公用设备工程师（给水排水）
                                                                rowIndex = -1;
                                                                for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                {
                                                                    if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == "75")
                                                                    {
                                                                        rowIndex = i;
                                                                        break;
                                                                    }
                                                                }
                                                                if (rowIndex < 0)
                                                                {
                                                                    row = dt_ryzymx.NewRow();
                                                                    dt_ryzymx.Rows.Add(row);
                                                                    row["ryID"] = personRegMajort.IDCardNo;
                                                                    row["ryzyzglxID"] = 75;
                                                                    row["ryzyzglx"] = "注册公用设备工程师（给水排水）";

                                                                    row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                    row["DataState"] = 0;
                                                                    row["tag"] = tag;
                                                                    row["xgr"] = "定时服务";
                                                                    row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                    dataService.Submit_uepp_Ryzymx(dt_ryzymx);
                                                                }
                                                                #endregion
                                                            }
                                                            else
                                                                if (regType.IndexOf("注册公用设备工程师（动力）") >= 0)
                                                                {
                                                                    #region 注册公用设备工程师（动力）

                                                                    rowIndex = -1;
                                                                    for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                    {
                                                                        if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == "76")
                                                                        {
                                                                            rowIndex = i;
                                                                            break;
                                                                        }
                                                                    }
                                                                    if (rowIndex < 0)
                                                                    {
                                                                        row = dt_ryzymx.NewRow();
                                                                        dt_ryzymx.Rows.Add(row);
                                                                        row["ryID"] = personRegMajort.IDCardNo;
                                                                        row["ryzyzglxID"] = "76";
                                                                        row["ryzyzglx"] = "注册公用设备工程师（动力）";
                                                                    }
                                                                    else
                                                                    {
                                                                        row = dt_ryzymx.Rows[rowIndex];
                                                                    }
                                                                    row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                    row["DataState"] = 0;
                                                                    row["tag"] = tag;
                                                                    row["xgr"] = "定时服务";
                                                                    row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                    dataService.Submit_uepp_Ryzymx(dt_ryzymx);
                                                                    #endregion

                                                                }
                                                                else
                                                                    if (regType.IndexOf("注册电气工程师（发输变电）") >= 0)
                                                                    {
                                                                        #region 注册电气工程师（发输变电）

                                                                        string ryzyzglxID = "77";
                                                                        rowIndex = -1;
                                                                        for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                        {
                                                                            if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == ryzyzglxID)
                                                                            {
                                                                                rowIndex = i;
                                                                                break;
                                                                            }
                                                                        }
                                                                        if (rowIndex < 0)
                                                                        {
                                                                            row = dt_ryzymx.NewRow();
                                                                            dt_ryzymx.Rows.Add(row);
                                                                            row["ryID"] = personRegMajort.IDCardNo;
                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                            row["ryzyzglx"] = "注册电气工程师（发输变电）";
                                                                        }
                                                                        else
                                                                        {
                                                                            row = dt_ryzymx.Rows[rowIndex];
                                                                        }
                                                                        row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                        row["DataState"] = 0;
                                                                        row["tag"] = tag;
                                                                        row["xgr"] = "定时服务";
                                                                        row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                        dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                                        #endregion
                                                                    }
                                                                    else
                                                                        if (regType.IndexOf("注册电气工程师（供配电）") >= 0)
                                                                        {
                                                                            #region 注册电气工程师（供配电）
                                                                            string ryzyzglxID = "78";
                                                                            rowIndex = -1;
                                                                            for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                            {
                                                                                if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == ryzyzglxID)
                                                                                {
                                                                                    rowIndex = i;
                                                                                    break;
                                                                                }
                                                                            }
                                                                            if (rowIndex < 0)
                                                                            {
                                                                                row = dt_ryzymx.NewRow();
                                                                                dt_ryzymx.Rows.Add(row);
                                                                                row["ryID"] = personRegMajort.IDCardNo;
                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                row["ryzyzglx"] = "注册电气工程师（供配电）";
                                                                            }
                                                                            else
                                                                            {
                                                                                row = dt_ryzymx.Rows[rowIndex];
                                                                            }
                                                                            row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                            row["DataState"] = 0;
                                                                            row["tag"] = tag;
                                                                            row["xgr"] = "定时服务";
                                                                            row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                            dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                                            #endregion
                                                                        }
                                                                        else
                                                                            if (regType.IndexOf("注册建造师") >= 0)
                                                                            {
                                                                                #region 注册建造师
                                                                                string ryzyzglxID = "1";
                                                                                rowIndex = -1;
                                                                                for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                                {
                                                                                    if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == ryzyzglxID && dt_ryzymx.Rows[i]["zyzglb"].ToString2() == personRegMajort.RegMajorDesc)
                                                                                    {
                                                                                        rowIndex = i;
                                                                                        break;
                                                                                    }
                                                                                }
                                                                                if (rowIndex < 0)
                                                                                {
                                                                                    row = dt_ryzymx.NewRow();
                                                                                    dt_ryzymx.Rows.Add(row);
                                                                                    row["ryID"] = personRegMajort.IDCardNo;
                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                    row["ryzyzglx"] = "注册建造师";

                                                                                    row["zyzglb"] = personRegMajort.RegMajorDesc;

                                                                                    if (!string.IsNullOrEmpty(personRegMajort.RegMajorDesc))
                                                                                    {
                                                                                        SqlParameterCollection sp = dataService.CreateSqlParameterCollection();
                                                                                        sp.Add("@CodeInfo", personRegMajort.RegMajorDesc);
                                                                                        sp.Add("@parentCode", ryzyzglxID);

                                                                                        DataTable dt_code = dataService.GetTable("select * from UEPP_Code where  CodeType='人员资质类别' and ParentCodeType='人员执业资格类型' and ParentCode=@parentCode and CodeInfo=@CodeInfo", sp);
                                                                                        if (dt_code.Rows.Count == 0)
                                                                                        {
                                                                                            dt_code.Rows.Add(dt_code.NewRow());
                                                                                            dt_code.Rows[0]["ParentCodeType"] = "人员执业资格类型";
                                                                                            dt_code.Rows[0]["ParentCode"] = ryzyzglxID;
                                                                                            dt_code.Rows[0]["CodeType"] = "人员资质类别";
                                                                                            dt_code.Rows[0]["CodeInfo"] = personRegMajort.RegMajorDesc.Trim();
                                                                                            dt_code.Rows[0]["Code"] = dataService.Get_uepp_Code_NewCode("人员资质类别");
                                                                                            dt_code.Rows[0]["CodeDesc"] = "";
                                                                                            dt_code.Rows[0]["OrderID"] = dt_code.Rows[0]["Code"];
                                                                                            dataService.Submit_uepp_code(dt_code);

                                                                                        }
                                                                                        row["zyzglbID"] = dt_code.Rows[0]["Code"];
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    row = dt_ryzymx.Rows[rowIndex];
                                                                                }

                                                                                if (regType.IndexOf("一级临时") >= 0)
                                                                                {
                                                                                    row["zyzgdjID"] = 3;
                                                                                    row["zyzgdj"] = "壹级临时";
                                                                                }
                                                                                else
                                                                                    if (regType.IndexOf("贰级临时") >= 0)
                                                                                    {
                                                                                        row["zyzgdjID"] = 4;
                                                                                        row["zyzgdj"] = "贰级临时";
                                                                                    }
                                                                                    else
                                                                                        if (regType.IndexOf("一级") >= 0)
                                                                                        {
                                                                                            row["zyzgdjID"] = 1;
                                                                                            row["zyzgdj"] = "壹级";
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            row["zyzgdjID"] = 2;
                                                                                            row["zyzgdj"] = "贰级";
                                                                                        }

                                                                                row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                                row["DataState"] = 0;
                                                                                row["tag"] = tag;
                                                                                row["xgr"] = "定时服务";
                                                                                row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                                dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                                                #endregion
                                                                            }
                                                                            else
                                                                                if (regType.IndexOf("小型项目管理师") >= 0)
                                                                                {
                                                                                    #region 小型项目管理师
                                                                                    string ryzyzglxID = "2";
                                                                                    rowIndex = -1;
                                                                                    for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                                    {
                                                                                        if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == ryzyzglxID && dt_ryzymx.Rows[i]["zyzgdjID"].ToString2() == "2")
                                                                                        {
                                                                                            rowIndex = i;
                                                                                            break;
                                                                                        }
                                                                                    }
                                                                                    if (rowIndex < 0)
                                                                                    {
                                                                                        row = dt_ryzymx.NewRow();
                                                                                        dt_ryzymx.Rows.Add(row);
                                                                                        row["ryID"] = personRegMajort.IDCardNo;
                                                                                        row["ryzyzglxID"] = ryzyzglxID;
                                                                                        row["ryzyzglx"] = "小型项目管理师";
                                                                                        row["zyzgdjID"] = 2;
                                                                                        row["zyzgdj"] = "小型";


                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        row = dt_ryzymx.Rows[rowIndex];
                                                                                    }
                                                                                    row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                                    row["DataState"] = 0;
                                                                                    row["tag"] = tag;
                                                                                    row["xgr"] = "定时服务";
                                                                                    row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                                    dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                                                    #endregion
                                                                                }
                                                                                else
                                                                                    if (regType.IndexOf("注册造价工程师") >= 0)
                                                                                    {
                                                                                        #region 注册造价工程师
                                                                                        string ryzyzglxID = "41";
                                                                                        rowIndex = -1;
                                                                                        for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                                        {
                                                                                            if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == ryzyzglxID)
                                                                                            {
                                                                                                rowIndex = i;
                                                                                                break;
                                                                                            }
                                                                                        }
                                                                                        if (rowIndex < 0)
                                                                                        {
                                                                                            row = dt_ryzymx.NewRow();
                                                                                            dt_ryzymx.Rows.Add(row);
                                                                                            row["ryID"] = personRegMajort.IDCardNo;
                                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                                            row["ryzyzglx"] = "注册造价工程师";

                                                                                            row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                                            row["DataState"] = 0;
                                                                                            row["tag"] = tag;
                                                                                            row["xgr"] = "定时服务";
                                                                                            row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                                            dataService.Submit_uepp_Ryzymx(dt_ryzymx);
                                                                                        }

                                                                                        #endregion
                                                                                    }
                                                                                    else
                                                                                        if (regType.IndexOf("注册监理工程师") >= 0)
                                                                                        {
                                                                                            #region 注册监理工程师
                                                                                            string ryzyzglxID = "21";
                                                                                            rowIndex = -1;
                                                                                            for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                                            {
                                                                                                if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == ryzyzglxID && dt_ryzymx.Rows[i]["zyzglb"].ToString2() == personRegMajort.RegMajorDesc)
                                                                                                {
                                                                                                    rowIndex = i;
                                                                                                    break;
                                                                                                }
                                                                                            }
                                                                                            if (rowIndex < 0)
                                                                                            {
                                                                                                row = dt_ryzymx.NewRow();
                                                                                                dt_ryzymx.Rows.Add(row);
                                                                                                row["ryID"] = personRegMajort.IDCardNo;
                                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                                row["ryzyzglx"] = "注册监理工程师";

                                                                                                row["zyzglb"] = personRegMajort.RegMajorDesc;

                                                                                                if (!string.IsNullOrEmpty(personRegMajort.RegMajorDesc))
                                                                                                {
                                                                                                    SqlParameterCollection sp = dataService.CreateSqlParameterCollection();
                                                                                                    sp.Add("@CodeInfo", personRegMajort.RegMajorDesc);
                                                                                                    sp.Add("@parentCode", ryzyzglxID);

                                                                                                    DataTable dt_code = dataService.GetTable("select * from UEPP_Code where  CodeType='人员资质类别' and ParentCodeType='人员执业资格类型' and ParentCode=@parentCode and CodeInfo=@CodeInfo", sp);
                                                                                                    if (dt_code.Rows.Count == 0)
                                                                                                    {
                                                                                                        dt_code.Rows.Add(dt_code.NewRow());
                                                                                                        dt_code.Rows[0]["ParentCodeType"] = "人员执业资格类型";
                                                                                                        dt_code.Rows[0]["ParentCode"] = ryzyzglxID;
                                                                                                        dt_code.Rows[0]["CodeType"] = "人员资质类别";
                                                                                                        dt_code.Rows[0]["CodeInfo"] = personRegMajort.RegMajorDesc.Trim();
                                                                                                        dt_code.Rows[0]["Code"] = dataService.Get_uepp_Code_NewCode("人员资质类别");
                                                                                                        dt_code.Rows[0]["CodeDesc"] = "";
                                                                                                        dt_code.Rows[0]["OrderID"] = dt_code.Rows[0]["Code"];
                                                                                                        dataService.Submit_uepp_code(dt_code);

                                                                                                    }
                                                                                                    row["zyzglbID"] = dt_code.Rows[0]["Code"];
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                row = dt_ryzymx.Rows[rowIndex];
                                                                                            }

                                                                                            row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                                            row["DataState"] = 0;
                                                                                            row["tag"] = tag;
                                                                                            row["xgr"] = "定时服务";
                                                                                            row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                                            dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                                                            #endregion
                                                                                        }
                                                                                        else
                                                                                            if (regType.IndexOf("注册城市规划师") >= 0)
                                                                                            {
                                                                                                #region 注册城市规划师
                                                                                                string ryzyzglxID = "79";
                                                                                                rowIndex = -1;
                                                                                                for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                                                {
                                                                                                    if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == ryzyzglxID)
                                                                                                    {
                                                                                                        rowIndex = i;
                                                                                                        break;
                                                                                                    }
                                                                                                }
                                                                                                if (rowIndex < 0)
                                                                                                {
                                                                                                    row = dt_ryzymx.NewRow();
                                                                                                    dt_ryzymx.Rows.Add(row);
                                                                                                    row["ryID"] = personRegMajort.IDCardNo;
                                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                                    row["ryzyzglx"] = "注册城市规划师";


                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    row = dt_ryzymx.Rows[rowIndex];
                                                                                                }
                                                                                                row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                                                row["DataState"] = 0;
                                                                                                row["tag"] = tag;
                                                                                                row["xgr"] = "定时服务";
                                                                                                row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                                                dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                                                                #endregion
                                                                                            }
                                                                                            else
                                                                                                if (regType.IndexOf("注册化工工程师") >= 0)
                                                                                                {
                                                                                                    #region 注册化工工程师
                                                                                                    string ryzyzglxID = "79";
                                                                                                    rowIndex = -1;
                                                                                                    for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                                                    {
                                                                                                        if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == ryzyzglxID)
                                                                                                        {
                                                                                                            rowIndex = i;
                                                                                                            break;
                                                                                                        }
                                                                                                    }
                                                                                                    if (rowIndex < 0)
                                                                                                    {
                                                                                                        row = dt_ryzymx.NewRow();
                                                                                                        dt_ryzymx.Rows.Add(row);
                                                                                                        row["ryID"] = personRegMajort.IDCardNo;
                                                                                                        row["ryzyzglxID"] = ryzyzglxID;
                                                                                                        row["ryzyzglx"] = "注册化工工程师";

                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        row = dt_ryzymx.Rows[rowIndex];
                                                                                                    }
                                                                                                    row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                                                    row["DataState"] = 0;
                                                                                                    row["tag"] = tag;
                                                                                                    row["xgr"] = "定时服务";
                                                                                                    row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                                                    dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                                                                    #endregion
                                                                                                }
                                                                                                else
                                                                                                    if (regType.IndexOf("注册房地产估价师") >= 0)
                                                                                                    {
                                                                                                        #region 注册房地产估价师
                                                                                                        string ryzyzglxID = "81";
                                                                                                        rowIndex = -1;
                                                                                                        for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                                                        {
                                                                                                            if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == ryzyzglxID)
                                                                                                            {
                                                                                                                rowIndex = i;
                                                                                                                break;
                                                                                                            }
                                                                                                        }
                                                                                                        if (rowIndex < 0)
                                                                                                        {
                                                                                                            row = dt_ryzymx.NewRow();
                                                                                                            dt_ryzymx.Rows.Add(row);
                                                                                                            row["ryID"] = personRegMajort.IDCardNo;
                                                                                                            row["ryzyzglxID"] = ryzyzglxID;
                                                                                                            row["ryzyzglx"] = "注册房地产估价师";
                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            row = dt_ryzymx.Rows[rowIndex];
                                                                                                        }
                                                                                                        row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                                                        row["DataState"] = 0;
                                                                                                        row["tag"] = tag;
                                                                                                        row["xgr"] = "定时服务";
                                                                                                        row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                                                        dataService.Submit_uepp_Ryzymx(dt_ryzymx);

                                                                                                        #endregion
                                                                                                    }
                                                                                                    else
                                                                                                        if (regType.IndexOf("注册房地产经纪人") >= 0)
                                                                                                        {
                                                                                                            #region 注册房地产经纪人
                                                                                                            string ryzyzglxID = "82";
                                                                                                            rowIndex = -1;
                                                                                                            for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                                                            {
                                                                                                                if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == ryzyzglxID)
                                                                                                                {
                                                                                                                    rowIndex = i;
                                                                                                                    break;
                                                                                                                }
                                                                                                            }
                                                                                                            if (rowIndex < 0)
                                                                                                            {
                                                                                                                row = dt_ryzymx.NewRow();
                                                                                                                dt_ryzymx.Rows.Add(row);
                                                                                                                row["ryID"] = personRegMajort.IDCardNo;
                                                                                                                row["ryzyzglxID"] = ryzyzglxID;
                                                                                                                row["ryzyzglx"] = "注册房地产经纪人";

                                                                                                            }
                                                                                                            else
                                                                                                            {
                                                                                                                row = dt_ryzymx.Rows[rowIndex];
                                                                                                            }
                                                                                                            row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                                                            row["DataState"] = 0;
                                                                                                            row["tag"] = tag;
                                                                                                            row["xgr"] = "定时服务";
                                                                                                            row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                                                            dataService.Submit_uepp_Ryzymx(dt_ryzymx);
                                                                                                            #endregion

                                                                                                        }
                                                                                                        else
                                                                                                            if (regType.IndexOf("物业管理师") >= 0)
                                                                                                            {
                                                                                                                #region 物业管理师
                                                                                                                string ryzyzglxID = "83";
                                                                                                                rowIndex = -1;
                                                                                                                for (int i = 0; i < dt_ryzymx.Rows.Count; i++)
                                                                                                                {
                                                                                                                    if (dt_ryzymx.Rows[i]["ryzyzglxID"].ToString2() == ryzyzglxID)
                                                                                                                    {
                                                                                                                        rowIndex = i;
                                                                                                                        break;
                                                                                                                    }
                                                                                                                }
                                                                                                                if (rowIndex < 0)
                                                                                                                {
                                                                                                                    row = dt_ryzymx.NewRow();
                                                                                                                    dt_ryzymx.Rows.Add(row);
                                                                                                                    row["ryID"] = personRegMajort.IDCardNo;
                                                                                                                    row["ryzyzglxID"] = ryzyzglxID;
                                                                                                                    row["ryzyzglx"] = "物业管理师";

                                                                                                                }
                                                                                                                else
                                                                                                                {
                                                                                                                    row = dt_ryzymx.Rows[rowIndex];
                                                                                                                }
                                                                                                                row["zzbz"] = (personRegMajort.IsMaster == "主项" || personRegMajort.IsMaster == "1") ? "主项" : "增项";
                                                                                                                row["DataState"] = 0;
                                                                                                                row["tag"] = tag;
                                                                                                                row["xgr"] = "定时服务";
                                                                                                                row["xgrqsj"] = personRegMajort.UpdateDate;
                                                                                                                dataService.Submit_uepp_Ryzymx(dt_ryzymx);
                                                                                                                #endregion
                                                                                                            }
                                                                                                            else
                                                                                                            {

                                                                                                            }





                                    }
                                    catch (Exception ex)
                                    {


                                    }
                                }
                            }

                            #endregion
                        }

                        #endregion
